<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pengisian Vendor Outsource</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        /* CSS untuk tabel dan form */
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Arial', sans-serif;
            background-color: #f8f9fa;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            padding: 20px;
            margin: 0;
        }

        .container {
            width: 100%;
            max-width: 1200px;
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0px 4px 6px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        h2 {
            text-align: center;
            font-size: 24px;
            color: #333;
            margin-bottom: 20px;
        }

        .table-wrapper {
            max-height: 500px;
            overflow-y: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th, td {
            padding: 12px;
            text-align: left;
            border: 1px solid #ddd;
        }

        th {
            background-color: #007bff;
            color: white;
        }

        tr:nth-child(even) {
            background-color: #f2f2f2;
        }

        tr:hover {
            background-color: #e9ecef;
        }

        .action-buttons {
            margin-top: 20px;
            text-align: center;
        }

        button {
            padding: 10px 20px;
            margin: 5px;
            background-color: #007bff;
            border: none;
            border-radius: 5px;
            color: white;
            cursor: pointer;
            font-size: 16px;
        }

        button:hover {
            background-color: #0056b3;
        }

        .form-container {
            display: none;
            background-color: white;
            padding: 20px;
            margin-top: 20px;
            border-radius: 8px;
            box-shadow: 0px 4px 6px rgba(0, 0, 0, 0.1);
        }

        .form-container.active {
            display: block;
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }

        .form-grid input, .form-grid select {
            padding: 10px;
            margin: 5px 0;
            width: 100%;
            border: 1px solid #ccc;
            border-radius: 5px;
        }

        .form-container button[type="submit"] {
            width: 100%;
            background-color: #28a745;
        }

        .form-container button[type="submit"]:hover {
            background-color: #218838;
        }

        .form-container button[type="button"] {
            background-color: #dc3545;
        }

        .form-container button[type="button"]:hover {
            background-color: #c82333;
        }

        @media (max-width: 768px) {
            .form-grid {
                grid-template-columns: 1fr 1fr;
            }
        }

        @media (max-width: 480px) {
            .form-grid {
                grid-template-columns: 1fr;
            }
        }

        /* Menyembunyikan kolom NO */
        th:nth-child(1), td:nth-child(1) {
            display: none;
        }
    </style>
</head>
<body>

    <div class="container">
        <h2>Pengisian Vendor Outsource</h2>

        <div class="table-wrapper">
            <table id="employee-table">
                <thead>
                    <tr>
                        <th>NO</th>
                        <th>Periode</th>
                        <th>Sumber Kandidat</th>
                        <th>Tanggal Pengiriman</th>
                        <th>Nama Kandidat</th>
                        <th>Jenis Kelamin</th>
                        <th>Tempat Lahir</th>
                        <th>Tanggal Lahir</th>
                        <th>Usia</th>
                        <th>Pendidikan</th>
                        <th>Nama Sekolah</th>
                        <th>Jurusan</th>
                        <th>IPK</th>
                        <th>Nilai</th>
                        <th>Tahun Lulus</th>
                        <th>Cabang Tujuan</th>
                        <th>Skill</th>
                        <th>Posisi Yang Dilamar</th>
                        <th>No Handphone</th>
                        <th>Email Kandidat</th>
                        <th>No KTP</th>
                        <th>Nama Ayah</th>
                        <th>Nama Ibu</th>
                        <th>Keterangan</th>
                        <th>Aksi</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- Data dinamis akan diisi menggunakan JavaScript -->
                </tbody>
            </table>
        </div>

        <div class="action-buttons">
            <button onclick="showForm()">Tambah Karyawan</button>
        </div>

        <div id="form-container" class="form-container">
            <h3 id="form-title">Tambah Karyawan</h3>
            <form id="employee-form">
                <input type="hidden" id="employee-id" value="">
                <div class="form-grid">
                    <input type="text" id="periode" placeholder="Periode" required>
                    <input type="text" id="sumber-kandidat" placeholder="Sumber Kandidat" required>
                    <input type="text" id="tanggal-pengiriman" placeholder="Tanggal Pengiriman" required>
                    <input type="text" id="nama-kandidat" placeholder="Nama Kandidat" required>
                    <select id="jenis-kelamin" required>
                        <option value="">Jenis Kelamin</option>
                        <option value="Pria">Pria</option>
                        <option value="Wanita">Wanita</option>
                    </select>
                    <input type="text" id="tempat-lahir" placeholder="Tempat Lahir" required>
                    <input type="date" id="tanggal-lahir" placeholder="Tanggal Lahir" required>
                    <input type="number" id="usia" placeholder="Usia" required>
                    <input type="text" id="pendidikan" placeholder="Pendidikan" required>
                    <input type="text" id="nama-sekolah" placeholder="Nama Sekolah" required>
                    <input type="text" id="jurusan" placeholder="Jurusan" required>
                    <input type="text" id="ipk" placeholder="IPK" required>
                    <input type="text" id="nilai" placeholder="Nilai" required>
                    <input type="text" id="tahun-lulus" placeholder="Tahun Lulus" required>
                    <input type="text" id="cabang-di-tuju" placeholder="Cabang Di Tuju" required>
                    <input type="text" id="skill" placeholder="Skill" required>
                    <input type="text" id="posisi-yang-dilamar" placeholder="Posisi yang Dilamar" required>
                    <input type="number" id="no-handphone" placeholder="No Handphone" required>
                    <input type="email" id="email-kandidat" placeholder="Email Kandidat" required>
                    <input type="text" id="noktp" placeholder="No KTP" required>
                    <input type="text" id="nama-ayah" placeholder="Nama Ayah" required>
                    <input type="text" id="nama-ibu" placeholder="Nama Ibu" required>
                    <input type="text" id="keterangan" placeholder="Keterangan" required>
                </div>
                <button type="submit">Simpan</button>
                <button type="button" onclick="closeForm()">Batal</button>
            </form>
        </div>
    </div>

    <script>
        const apiUrl = 'https://localhost:8080/api/karyawan-outsource';
        
        function formatDate(dateString) {
            const [year, month, day] = dateString.split('-');
            return `${day}/${month}/${year}`;
        }
        
        // Menampilkan form untuk tambah atau edit karyawan
        function showForm(employee = null) {
            document.getElementById('form-container').classList.add('active');
            if (employee) {
                document.getElementById('form-title').textContent = 'Edit Karyawan';
                document.getElementById('employee-id').value = employee.no;
                document.getElementById('periode').value = employee.periode;
                document.getElementById('sumber-kandidat').value = employee.sumberKandidat;
                document.getElementById('tanggal-pengiriman').value = employee.tanggalPengiriman;
                document.getElementById('nama-kandidat').value = employee.namaKandidat;
                document.getElementById('jenis-kelamin').value = employee.jenisKelamin;
                document.getElementById('tempat-lahir').value = employee.tempatLahir;
                document.getElementById('tanggal-lahir').value = formatDate(employee.tanggalLahir);
                document.getElementById('usia').value = employee.usia;
                document.getElementById('pendidikan').value = employee.pendidikan;
                document.getElementById('nama-sekolah').value = employee.namaSekolah;
                document.getElementById('jurusan').value = employee.jurusan;
                document.getElementById('ipk').value = employee.ipk;
                document.getElementById('nilai').value = employee.nilai;
                document.getElementById('tahun-lulus').value = employee.tahunLulus;
                document.getElementById('cabang-di-tuju').value = employee.cabangDiTuju;
                document.getElementById('skill').value = employee.skill;
                document.getElementById('posisi-yang-dilamar').value = employee.posisiYangDilamar;
                document.getElementById('no-handphone').value = employee.noHandphone;
                document.getElementById('email-kandidat').value = employee.emailKandidat;
                document.getElementById('noktp').value = employee.noKTP;
                document.getElementById('nama-ayah').value = employee.namaAyah;
                document.getElementById('nama-ibu').value = employee.namaIbu;
                document.getElementById('keterangan').value = employee.keterangan;
            } else {
                document.getElementById('form-title').textContent = 'Tambah Karyawan';
                document.getElementById('employee-form').reset();
            }
        }
        
        

        // Menyembunyikan form
        function closeForm() {
            document.getElementById('form-container').classList.remove('active');
        }

        // Mengupdate data karyawan
        function editEmployee(id) {
            fetch(`${apiUrl}/${id}`)
                .then(response => response.json())
                .then(employee => {
                    showForm(employee);
                })
                .catch(error => console.error('Error:', error));
        }

        // Menghapus data karyawan
        function deleteEmployee(id) {
            if (confirm('Apakah Anda yakin ingin menghapus data ini?')) {
                fetch(`${apiUrl}/${id}`, {
                    method: 'DELETE',
                })
                .then(() => {
                    alert('Data berhasil dihapus');
                    loadEmployees(); // Reload daftar karyawan
                })
                .catch(error => console.error('Error:', error));
            }
        }

        // Menambahkan atau mengupdate data karyawan
        document.getElementById('employee-form').addEventListener('submit', function(event) {
            event.preventDefault();
            const employee = {
                periode: document.getElementById('periode').value,
                sumberKandidat: document.getElementById('sumber-kandidat').value,
                tanggalPengiriman: document.getElementById('tanggal-pengiriman').value,
                namaKandidat: document.getElementById('nama-kandidat').value,
                jenisKelamin: document.getElementById('jenis-kelamin').value,
                tempatLahir: document.getElementById('tempat-lahir').value,
                tanggalLahir: document.getElementById('tanggal-lahir').value,
                usia: document.getElementById('usia').value,
                pendidikan: document.getElementById('pendidikan').value,
                namaSekolah: document.getElementById('nama-sekolah').value,
                jurusan: document.getElementById('jurusan').value,
                ipk: document.getElementById('ipk').value,
                nilai: document.getElementById('nilai').value,
                tahunLulus: document.getElementById('tahun-lulus').value,
                cabangDiTuju: document.getElementById('cabang-di-tuju').value,
                skill: document.getElementById('skill').value,
                posisiYangDilamar: document.getElementById('posisi-yang-dilamar').value,
                noHandphone: document.getElementById('no-handphone').value,
                emailKandidat: document.getElementById('email-kandidat').value,
                noKTP: document.getElementById('noktp').value,
                namaAyah: document.getElementById('nama-ayah').value,
                namaIbu: document.getElementById('nama-ibu').value,
                keterangan: document.getElementById('keterangan').value
            };
            
            const id = document.getElementById('employee-id').value;

            const method = id ? 'PUT' : 'POST';
            const url = id ? `${apiUrl}/${id}` : apiUrl;
            
            fetch(url, {
                method: method,
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(employee)
            })
            .then(response => response.json())
            .then(data => {
                loadEmployees();  // Reload karyawan setelah simpan
                closeForm(); // Tutup form
            })
            .catch(error => console.error('Error:', error));
        });

        // Memuat data karyawan
        function loadEmployees() {
            fetch(apiUrl)
                .then(response => response.json())
                .then(data => {
                    const table = document.getElementById('employee-table').getElementsByTagName('tbody')[0];
                    table.innerHTML = '';  // Clear existing rows
                    data.forEach(employee => {
                        const row = table.insertRow();
                        row.setAttribute('data-id', employee.no);
                        row.innerHTML = `
                            <td>${employee.no}</td>
                            <td>${employee.periode}</td>
                            <td>${employee.sumberKandidat}</td>
                            <td>${employee.tanggalPengiriman}</td>
                            <td>${employee.namaKandidat}</td>
                            <td>${employee.jenisKelamin}</td>
                            <td>${employee.tempatLahir}</td>
                            <td>${employee.tanggalLahir}</td>
                            <td>${employee.usia}</td>
                            <td>${employee.pendidikan}</td>
                            <td>${employee.namaSekolah}</td>
                            <td>${employee.jurusan}</td>
                            <td>${employee.ipk}</td>
                            <td>${employee.nilai}</td>
                            <td>${employee.tahunLulus}</td>
                            <td>${employee.cabangDiTuju}</td>
                            <td>${employee.skill}</td>
                            <td>${employee.posisiYangDilamar}</td>
                            <td>${employee.noHandphone}</td>
                            <td>${employee.emailKandidat}</td>
                            <td>${employee.noKTP}</td>
                            <td>${employee.namaAyah}</td>
                            <td>${employee.namaIbu}</td>
                            <td>${employee.keterangan}</td>
                            <td>
                                <button onclick="editEmployee(${employee.no})">Edit</button>
                                <button onclick="deleteEmployee(${employee.no})">Delete</button>
                            </td>
                        `;
                    });
                })
                .catch(error => console.error('Error:', error));
        }

        // Muat karyawan saat halaman pertama kali dimuat
        window.onload = loadEmployees;
    </script>
</body>
</html>
